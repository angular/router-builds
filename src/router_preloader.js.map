{"version":3,"sources":["../../../../modules/@angular/router/src/router_preloader.ts"],"names":[],"mappings":"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","file":"router_preloader.js","sourceRoot":"","sourcesContent":["/**\n*@license\n*Copyright Google Inc. All Rights Reserved.\n*\n*Use of this source code is governed by an MIT-style license that can be\n*found in the LICENSE file at https://angular.io/license\n*/\n\nimport {Compiler, Injectable, Injector, NgModuleFactoryLoader} from '@angular/core/index';\nimport {Observable} from 'rxjs/Observable';\nimport {Subscription} from 'rxjs/Subscription';\nimport {from} from 'rxjs/observable/from';\nimport {of } from 'rxjs/observable/of';\nimport {_catch} from 'rxjs/operator/catch';\nimport {concatMap} from 'rxjs/operator/concatMap';\nimport {filter} from 'rxjs/operator/filter';\nimport {mergeAll} from 'rxjs/operator/mergeAll';\nimport {mergeMap} from 'rxjs/operator/mergeMap';\n\nimport {Route, Routes} from './config';\nimport {NavigationEnd, Router} from './router';\nimport {RouterConfigLoader} from './router_config_loader';\n/**\n * \\@whatItDoes Provides a preloading strategy.\n * \n * \\@experimental\n * @abstract\n */\nexport abstract class PreloadingStrategy {\n/**\n * @abstract\n * @param {?} route\n * @param {?} fn\n * @return {?}\n */\npreload(route: Route, fn: () => Observable<any>) {}\n}\n/**\n * \\@whatItDoes Provides a preloading strategy that preloads all modules as quicky as possible.\n * \n * \\@howToUse \n * \n * ```\n * RouteModule.forRoot(ROUTES, {preloadingStrategy: PreloadAllModules})\n * ```\n * \n * \\@experimental\n */\nexport class PreloadAllModules implements PreloadingStrategy {\n/**\n * @param {?} route\n * @param {?} fn\n * @return {?}\n */\npreload(route: Route, fn: () => Observable<any>): Observable<any> {\n    return _catch.call(fn(), () => of (null));\n  }\n}\n/**\n * \\@whatItDoes Provides a preloading strategy that does not preload any modules.\n * \n * \\@description \n * \n * This strategy is enabled by default.\n * \n * \\@experimental\n */\nexport class NoPreloading implements PreloadingStrategy {\n/**\n * @param {?} route\n * @param {?} fn\n * @return {?}\n */\npreload(route: Route, fn: () => Observable<any>): Observable<any> { return of (null); }\n}\n/**\n * The preloader optimistically loads all router configurations to\n * make navigations into lazily-loaded sections of the application faster.\n * \n * The preloader runs in the background. When the router bootstraps, the preloader\n * starts listening to all navigation events. After every such event, the preloader\n * will check if any configurations can be loaded lazily.\n * \n * If a route is protected by `canLoad` guards, the preloaded will not load it.\n * \n * \\@stable\n */\nexport class RouterPreloader {\nprivate loader: RouterConfigLoader;\nprivate subscription: Subscription;\n/**\n * @param {?} router\n * @param {?} moduleLoader\n * @param {?} compiler\n * @param {?} injector\n * @param {?} preloadingStrategy\n */\nconstructor(\nprivate router: Router, moduleLoader: NgModuleFactoryLoader, compiler: Compiler,\nprivate injector: Injector,\nprivate preloadingStrategy: PreloadingStrategy) {\n    this.loader = new RouterConfigLoader(moduleLoader, compiler);\n  };\n/**\n * @return {?}\n */\nsetUpPreloading(): void {\n    const /** @type {?} */ navigations = filter.call(this.router.events, (e: any) => e instanceof NavigationEnd);\n    this.subscription = concatMap.call(navigations, () => this.preload()).subscribe((v: any) => {});\n  }\n/**\n * @return {?}\n */\npreload(): Observable<any> { return this.processRoutes(this.injector, this.router.config); }\n/**\n * @return {?}\n */\nngOnDestroy() { this.subscription.unsubscribe(); }\n/**\n * @param {?} injector\n * @param {?} routes\n * @return {?}\n */\nprivate processRoutes(injector: Injector, routes: Routes): Observable<void> {\n    const /** @type {?} */ res: Observable<any>[] = [];\n    for (const /** @type {?} */ c of routes) {\n      // we already have the config loaded, just recurse\n      if (c.loadChildren && !c.canLoad && ( /** @type {?} */((<any>c)))._loadedConfig) {\n        const /** @type {?} */ childConfig = ( /** @type {?} */((<any>c)))._loadedConfig;\n        res.push(this.processRoutes(childConfig.injector, childConfig.routes));\n\n        // no config loaded, fetch the config\n      } else if (c.loadChildren && !c.canLoad) {\n        res.push(this.preloadConfig(injector, c));\n\n        // recurse into children\n      } else if (c.children) {\n        res.push(this.processRoutes(injector, c.children));\n      }\n    }\n    return mergeAll.call(from(res));\n  }\n/**\n * @param {?} injector\n * @param {?} route\n * @return {?}\n */\nprivate preloadConfig(injector: Injector, route: Route): Observable<void> {\n    return this.preloadingStrategy.preload(route, () => {\n      const /** @type {?} */ loaded = this.loader.load(injector, route.loadChildren);\n      return mergeMap.call(loaded, (config: any): any => {\n        const /** @type {?} */ c: any = route;\n        c._loadedConfig = config;\n        return this.processRoutes(config.injector, config.routes);\n      });\n    });\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: Router, },\n{type: NgModuleFactoryLoader, },\n{type: Compiler, },\n{type: Injector, },\n{type: PreloadingStrategy, },\n];\n}\n\nfunction RouterPreloader_tsickle_Closure_declarations() {\n/** @type {?} */\nRouterPreloader.decorators;\n/**\n * @nocollapse\n * @type {?}\n */\nRouterPreloader.ctorParameters;\n/** @type {?} */\nRouterPreloader.prototype.loader;\n/** @type {?} */\nRouterPreloader.prototype.subscription;\n/** @type {?} */\nRouterPreloader.prototype.router;\n/** @type {?} */\nRouterPreloader.prototype.injector;\n/** @type {?} */\nRouterPreloader.prototype.preloadingStrategy;\n}\n\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}